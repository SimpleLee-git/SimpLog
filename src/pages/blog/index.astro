---
import { getCollection } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import Footer from "../../components/Footer.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import Header from "../../components/Header.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";

const posts = (await getCollection("blog")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const categoryTitle = "모든 글";
---

<!doctype html>
<html lang="ko">
	<head>
		<BaseHead
			title={`${categoryTitle} | ${SITE_TITLE}`}
			description={SITE_DESCRIPTION}
		/>
	</head>
	<body class="max-w-4xl mx-auto">
		<Header />
		<main class="px-6 py-12">
			<section>
				<h1 class="text-3xl font-bold mb-12 tracking-tight">
					{categoryTitle}
				</h1>
				<ul class="space-y-12">
					{
						posts.map((post) => (
							<li class="group">
								<a
									href={`${import.meta.env.BASE_URL.replace(
										/\/$/,
										"",
									)}/blog/${post.id}/`}
									class="block hover:no-underline"
								>
									<div class="flex flex-col md:flex-row md:items-baseline justify-between gap-2">
										<div class="flex flex-col">
											<h2 class="text-xl font-semibold group-hover:text-[var(--accent)] transition-colors">
												{post.data.title}
											</h2>
											{post.data.tags && (
												<div class="flex gap-2 mt-1">
													{post.data.tags.map(
														(tag) => (
															<span class="text-[10px] uppercase tracking-widest text-[var(--text-muted)] border border-[var(--border-color)] px-1.5 py-0.5 rounded">
																{tag}
															</span>
														),
													)}
												</div>
											)}
										</div>
										<p class="text-sm text-[var(--text-muted)] whitespace-nowrap">
											<FormattedDate
												date={post.data.pubDate}
											/>
										</p>
									</div>
								</a>
							</li>
						))
					}
				</ul>
				{
					posts.length === 0 && (
						<p class="text-[var(--text-muted)] italic">
							아직 작성된 글이 없습니다.
						</p>
					)
				}
			</section>
		</main>
		<Footer />
	</body>
</html>
